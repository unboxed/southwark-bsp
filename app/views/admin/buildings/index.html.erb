<div class="admin">
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-one-half">
      <h1 class="govuk-heading-l">All buildings</h1>
    </div>

    <div class="govuk-grid-column-one-half admin-actions">
      <%= link_to "Export data for Delta", admin_buildings_path(:csv), class: "govuk-button govuk-button--download" %>
    </div>
  </div>

  <h2 class="govuk-body-l govuk-!-margin-top-5 govuk-!-margin-bottom-4">
    <strong>
      <%= t(:"admin.headers.buildings.prefix") %>
    </strong>

    <%= t(:"admin.headers.buildings.total", count: @buildings.facets[:all]) %>
  </h2>



  <div>
    <ul class="govuk-tabs__list" role="tablist">
      <% SurveyStateMachine.states.each do |state| %>
        <li class="govuk-tabs__list-item <%= @current_state == state ? "govuk-tabs__list-item--selected"  : "" %>" role="presentation">
          <%= link_to state.humanize, admin_buildings_path(state: state), class: "govuk-tabs__tab", role: "tab" %>
        </li>
      <% end %>
    </ul>
  </div>

  <div class="govuk-tabs__panel" id="<%= @current_state %>">
    <h2 class="govuk-heading-l"><%= @current_state.humanize %></h2>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header">UPRN</th>
          <th scope="col" class="govuk-table__header">Building</th>
          <th scope="col" class="govuk-table__header">Owner</th>
          <th scope="col" class="govuk-table__header">Imported</th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        <% @buildings.each do |building| %>
          <tr class="govuk-table__row">
            <td class="govuk-table__cell">
              <%= link_to building.uprn, admin_building_path(building), class: "govuk-link" %>
            </td>
            <td class="govuk-table__cell">
              <%= building.building_name %></td>
            <td class="govuk-table__cell">
              <%= building.land_registry_proprietor_name %>
            </td>
            <td class="govuk-table__cell">
              <%= short_date_format(building.created_at) %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
